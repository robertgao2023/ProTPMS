<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>ATIS vs ProTPMS 投资回报计算器 — 中国版（人民币，公里，升/百公里）v1</title>
<style>
  :root{
    --bg:#0b1020;
    --card:#11162a;
    --elev:#0d1326;
    --border:#1e2a4a;
    --text:#e6ecff;
    --muted:#aab4d6;
  }
  *{box-sizing:border-box}
  html,body{margin:0;padding:0;background:var(--bg);color:var(--text);font-family: Arial, "Noto Sans SC", "PingFang SC", "Microsoft YaHei", Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica}
  .container{max-width:1100px;margin:0 auto;padding:28px 20px 80px}
  .hero{
    background: radial-gradient(1200px 600px at 10% -20%, rgba(124,156,255,.25), transparent),
                radial-gradient(800px 400px at 100% 0%, rgba(34,211,238,.18), transparent);
    border:1px solid var(--border);
    border-radius:18px;padding:28px 28px 22px;margin-bottom:24px
  }
  .hero h1{margin:0 0 6px;font-weight:900;letter-spacing:.2px;font-size:34px;line-height:1.15;color:#fff;}
  .hero .kicker{color:var(--muted);font-size:14px}
  .hero .controls{margin-top:14px;display:flex;gap:12px;flex-wrap:wrap;align-items:center}
  select, input[type="number"]{
    background:#0c1228;border:1px solid var(--border);color:#e6ecff;
    padding:10px 12px;border-radius:10px;font:inherit;outline:none;min-width:120px;
  }
  .pill{display:inline-flex;align-items:center;gap:8px;padding:6px 12px;border-radius:999px;
    background:rgba(124,156,255,.14);color:#cfe0ff;font-weight:600;font-size:12px;border:1px solid var(--border)}
  .row{display:flex;gap:12px;flex-wrap:wrap;align-items:center}
  .section{border:1px solid var(--border);border-radius:16px;background:linear-gradient(180deg,var(--card),var(--elev));padding:18px;margin-top:18px}
  .section h2{margin:0 0 12px;font-size:26px;line-height:1.2;font-weight:900;letter-spacing:.2px}
  .section h2 .tag{font-size:12px;font-weight:700;color:#c7d2fe;margin-left:10px;padding:4px 8px;border-radius:999px;background:rgba(124,156,255,.18);border:1px solid var(--border)}
  .grid{display:grid;grid-template-columns: 1fr 1fr; gap:18px}
  fieldset{border:1px dashed var(--border);border-radius:12px;padding:14px}
  legend{padding:0 8px;color:#c7d2fe;font-weight:700}
  label{display:grid;grid-template-columns: 1fr 190px; align-items:center; gap:10px; font-size:13px; margin:8px 0}
  .muted{color:var(--muted);font-size:12px}
  .sub{font-size:12px;color:#c7d2fe;margin-top:6px}
  table{width:100%; border-collapse:collapse; margin-top:10px;background:#0c1228;border:1px solid var(--border);border-radius:12px;overflow:hidden}
  th, td{border-top:1px solid var(--border); padding:10px 10px; text-align:right; font-variant-numeric: tabular-nums}
  th:first-child, td:first-child{text-align:left}
  th{background:rgba(124,156,255,.08);font-weight:800}
  .kpi{font-weight:800}
  .kpi-row td{background:linear-gradient(90deg, rgba(124,156,255,.08), rgba(124,156,255,0));}
  @media (max-width: 900px){ .grid{grid-template-columns:1fr} label{grid-template-columns:1fr 160px}}
</style>
</head>
<body>
<div class="container">

  <!-- HERO -->
  <div class="hero">
    
  <div class="row" style="align-items:center; gap:20px; flex-wrap:wrap;">
    <img src="logo dark bgd.jpg" alt="ProDrive Industrial Logo" 
         style="height:70px; border-radius:8px; background:#0f0e0e; padding:4px;">
    <div>

      <h1>ATIS 与 ProTPMS 投资回报计算器</h1>
      <span class="pill">人民币 · 公里 · 升/百公里 · 元/升</span>
    </div>
    <div class="kicker">一页交互式测算：调整参数，立即看到回收期与 ROI。</div>
    <div class="controls">
      <label style="display:flex;gap:10px;align-items:center">
        <span>情景</span>
        <select id="scenario">
          <option>保守</option>
          <option selected>基准</option>
          <option>乐观</option>
        </select>
      </label>
      <span class="muted">切换情景将自动填充百分比假设（仍可手动微调）。</span>
    </div>
  </div>

  <!-- 基线输入 -->
  <section class="section">
    <h2>半挂车基本情况 <span class="tag">输入参数</span></h2>
    <div class="grid">
      <fieldset>
        <legend>车辆 & 轮胎</legend>
        <label> 轮胎数量（个） <input id="tire_count" type="number" value="12" step="1"></label>
        <label> 轮胎单价（¥/个） <input id="tire_price" type="number" value="1200" step="10"></label>
        <label> 轮胎寿命（公里） <input id="tire_life" type="number" value="120000" step="1000"></label>
        <label> 年行驶里程（公里） <input id="annual_km" type="number" value="160000" step="1000"></label>
        <label> 油耗（升/百公里） <input id="l_per_100km" type="number" value="35" step="0.5"></label>
        <label> 柴油价格（¥/升） <input id="diesel_price" type="number" value="8" step="0.1"></label>
        <div class="sub">燃油成本 = （年里程 ÷ 100 × 升/百公里）× 元/升</div>
      </fieldset>

      <fieldset>
        <legend>事故 & 日常检查</legend>
        <label> 平均故障频率（次/年） <input id="fail_freq" type="number" value="0.7" step="0.1"></label>
        <label> 单次故障损失（¥/次） <input id="fail_loss" type="number" value="5000" step="100"></label>
        <div class="divider"></div>
        <label> 出车前轮胎检查（分钟/天） <input id="daily_mins" type="number" value="8" step="1"></label>
        <label> 人工费率（¥/分钟） <input id="per_min" type="number" value="2" step="0.5"></label>
        <div class="sub">ATIS 可免去此例行检查。年人工维护成本（无 ATIS）= 365 × 分钟/天 × ¥/分钟。</div>
      </fieldset>
    </div>
  </section>

  <!-- 参数因子 -->
  <section class="section">
    <h2>参数因子 <span class="tag">情景驱动</span></h2>
    <div class="grid">
      <fieldset>
        <legend>安装ATIS的影响因子</legend>
        <label> ATIS 燃油节省（%） <input id="atis_fuel" type="number" value="2" step="0.5"></label>
        <label> ATIS 轮胎节省（%） <input id="atis_tire" type="number" value="15" step="1"></label>
        <label> ATIS 故障减少（%） <input id="atis_fail" type="number" value="50" step="5"></label>
        <div class="sub">请输入百分比，例如 2 = 2%。</div>
      </fieldset>
      <fieldset>
        <legend>安装TPMS的影响因子</legend>
        <label> TPMS 燃油节省（%） <input id="tpms_fuel" type="number" value="1.5" step="0.5"></label>
        <label> TPMS 轮胎节省（%） <input id="tpms_tire" type="number" value="10" step="1"></label>
        <label> TPMS 故障减少（%） <input id="tpms_fail" type="number" value="50" step="5"></label>
        <div class="sub">TPMS 依赖人工及时处理；效果可能接近 ATIS，但更依赖执行。</div>
      </fieldset>
      <fieldset>
        <legend>ATIS和TPMS组合安装 & 费用</legend>
        <label> TPMS 数据费（¥/月） <input id="tpms_data_mo" type="number" value="35" step="1"></label>
        <label> 故障重叠度（0–100%） <input id="overlap" type="number" value="80" step="5" min="0" max="100"></label>
        <label> 管理便利价值（¥/年） <input id="mgmt_value" type="number" value="800" step="50"></label>
        <div class="sub">组合对燃油/轮胎取 ATIS 与 TPMS 的最大值，避免双重计算；故障减少按重叠度融合。</div>
      </fieldset>
      <fieldset>
        <legend>一次性投资</legend>
        <label> ATIS 购置成本（¥） <input id="atis_cost" type="number" value="5000" step="100"></label>
        <label> ProTPMS 购置成本（¥） <input id="tpms_cost" type="number" value="3500" step="100"></label>
      </fieldset>
    </div>
  </section>

  <!-- 基线结果 -->
  <section class="section">
    <h2>成本基线 <span class="tag">结果</span></h2>
    <table>
      <tr><th>指标</th><th>金额（¥）</th></tr>
      <tr><td>年燃油成本</td><td id="base_fuel">-</td></tr>
      <tr><td>年轮胎成本</td><td id="base_tire">-</td></tr>
      <tr><td>年预期故障损失</td><td id="base_fail">-</td></tr>
      <tr class="kpi-row"><td class="kpi">基线合计/年</td><td class="kpi" id="base_total">-</td></tr>
    </table>
  </section>

  <!-- ATIS 结果 -->
  <section class="section">
    <h2>ATIS <span class="tag">节省 & 回收</span></h2>
    <table>
      <tr><th>指标</th><th>金额（¥）</th></tr>
      <tr><td>燃油节省/年</td><td id="atis_fs">-</td></tr>
      <tr><td>轮胎节省/年</td><td id="atis_ts">-</td></tr>
      <tr><td>人工/停运节省/年</td><td id="atis_ms">-</td></tr>
      <tr><td>故障损失减少/年</td><td id="atis_rs">-</td></tr>
      <tr class="kpi-row"><td class="kpi">总节省/年</td><td class="kpi" id="atis_total">-</td></tr>
      <tr><td>一次性成本</td><td id="atis_cap">-</td></tr>
      <tr class="kpi-row"><td class="kpi">回收期（月）</td><td class="kpi" id="atis_pb_mo">-</td></tr>
      <tr class="kpi-row"><td class="kpi">ROI（首年）</td><td class="kpi" id="atis_roi">-</td></tr>
    </table>
  </section>

  <!-- TPMS 结果 -->
  <section class="section">
    <h2>ProTPMS <span class="tag">节省 & 回收</span></h2>
    <table>
      <tr><th>指标</th><th>金额（¥）</th></tr>
      <tr><td>燃油节省/年</td><td id="tpms_fs">-</td></tr>
      <tr><td>轮胎节省/年</td><td id="tpms_ts">-</td></tr>
      <tr><td>故障损失减少/年</td><td id="tpms_rs">-</td></tr>
      <tr><td>数据费/年</td><td id="tpms_fee">-</td></tr>
      <tr class="kpi-row"><td class="kpi">净节省/年（含数据费）</td><td class="kpi" id="tpms_net">-</td></tr>
      <tr><td>一次性成本</td><td id="tpms_cap">-</td></tr>
      <tr class="kpi-row"><td class="kpi">回收期（月）</td><td class="kpi" id="tpms_pb_mo">-</td></tr>
      <tr class="kpi-row"><td class="kpi">ROI（首年）</td><td class="kpi" id="tpms_roi">-</td></tr>
    </table>
  </section>

  <!-- 组合结果 -->
  <section class="section">
    <h2>组合（ATIS + ProTPMS） <span class="tag">避免双重计算</span></h2>
    <table>
      <tr><th>指标</th><th>金额（¥）</th></tr>
      <tr><td>燃油节省/年</td><td id="combo_fs">-</td></tr>
      <tr><td>轮胎节省/年</td><td id="combo_ts">-</td></tr>
      <tr><td>故障损失减少/年</td><td id="combo_rs">-</td></tr>
      <tr><td>管理便利价值/年</td><td id="combo_mgmt">-</td></tr>
      <tr><td>数据费/年</td><td id="combo_fee">-</td></tr>
      <tr class="kpi-row"><td class="kpi">净节省/年</td><td class="kpi" id="combo_net">-</td></tr>
      <tr><td>一次性成本</td><td id="combo_cap">-</td></tr>
      <tr class="kpi-row"><td class="kpi">回收期（月）</td><td class="kpi" id="combo_pb_mo">-</td></tr>
      <tr class="kpi-row"><td class="kpi">ROI（首年）</td><td class="kpi" id="combo_roi">-</td></tr>
    </table>
  </section>

</div>

<script>
const $ = id => document.getElementById(id);
const fmt = v => isFinite(v) ? v.toLocaleString(undefined,{maximumFractionDigits:0}) : "-";

// 情景预设（百分比直接以“点”输入，如 2=2%）
const scenarioPresets = {
  "保守": {atis_fuel:1, atis_tire:10, atis_fail:30, tpms_fuel:1, tpms_tire:5, tpms_fail:40, tpms_data_mo:30, overlap:80},
  "基准": {atis_fuel:2, atis_tire:15, atis_fail:50, tpms_fuel:1.5, tpms_tire:10, tpms_fail:50, tpms_data_mo:35, overlap:80},
  "乐观": {atis_fuel:3, atis_tire:20, atis_fail:60, tpms_fuel:2, tpms_tire:15, tpms_fail:60, tpms_data_mo:50, overlap:70},
};

function applyScenario() {
  const p = scenarioPresets[$("scenario").value];
  $("atis_fuel").value = p.atis_fuel;
  $("atis_tire").value = p.atis_tire;
  $("atis_fail").value = p.atis_fail;
  $("tpms_fuel").value = p.tpms_fuel;
  $("tpms_tire").value = p.tpms_tire;
  $("tpms_fail").value = p.tpms_fail;
  $("tpms_data_mo").value = p.tpms_data_mo;
  if (p.overlap !== undefined) $("overlap").value = p.overlap;
  calc();
}

function num(id){ return parseFloat($(id).value)||0; }

function calc(){
  // 输入
  const tires = num("tire_count"), tirePrice=num("tire_price"), tireLife=num("tire_life");
  const km=num("annual_km"), lper100=num("l_per_100km"), diesel=num("diesel_price");
  const failFreq=num("fail_freq"), failLoss=num("fail_loss");
  const dailyMins=num("daily_mins"), perMin=num("per_min");
  const atisCap=num("atis_cost"), tpmsCap=num("tpms_cost"), tpmsDataMo=num("tpms_data_mo");

  // 百分比（转小数）
  const atisFuel=num("atis_fuel")/100, atisTire=num("atis_tire")/100, atisFail=num("atis_fail")/100;
  const tpmsFuel=num("tpms_fuel")/100, tpmsTire=num("tpms_tire")/100, tpmsFail=num("tpms_fail")/100;
  const overlap=Math.min(100,Math.max(0, num("overlap")))/100;
  const mgmt=num("mgmt_value");

  // 基线
  const liters = (km/100) * lper100;
  const baseFuel = liters * diesel;
  const baseTire = (tireLife>0 ? km/tireLife : 0) * tires * tirePrice;
  const baseFail = failFreq * failLoss;
  const baseTotal = baseFuel + baseTire + baseFail;

  // ATIS 日常服务节省（免检查）
  const atisMaintYr = 365 * dailyMins * perMin;

  // ATIS
  const atisFuelSav = baseFuel * atisFuel;
  const atisTireSav = baseTire - baseTire/(1+atisTire);
  const atisFailSav = baseFail * atisFail;
  const atisTotalSav = atisFuelSav + atisTireSav + atisMaintYr + atisFailSav;
  const atisPaybackYears = atisTotalSav>0 ? atisCap/atisTotalSav : NaN;

  // TPMS
  const tpmsFuelSav = baseFuel * tpmsFuel;
  const tpmsTireSav = baseTire - baseTire/(1+tpmsTire);
  const tpmsFailSav = baseFail * tpmsFail;
  const tpmsFeeYr = 12 * tpmsDataMo;
  const tpmsNetSav = tpmsFuelSav + tpmsTireSav + tpmsFailSav - tpmsFeeYr;
  const tpmsPaybackYears = tpmsNetSav>0 ? tpmsCap/tpmsNetSav : NaN;

  // 组合（避免双重计算）
  const comboFuelPct = Math.max(atisFuel, tpmsFuel);
  const comboTirePct = Math.max(atisTire, tpmsTire);
  const maxFail = Math.max(atisFail, tpmsFail);
  const minFail = Math.min(atisFail, tpmsFail);
  const comboFailPct = Math.min(1, maxFail + minFail*(1-overlap));

  const comboFuelSav = baseFuel * comboFuelPct;
  const comboTireSav = baseTire - baseTire/(1+comboTirePct);
  const comboFailSav = baseFail * comboFailPct;
  const comboFeeYr = tpmsFeeYr;
  const comboCap = atisCap + tpmsCap;
  const comboNet = comboFuelSav + comboTireSav + comboFailSav + mgmt - comboFeeYr;
  const comboPaybackYears = comboNet>0 ? comboCap/comboNet : NaN;

  // 输出
  $("base_fuel").textContent = "¥" + fmt(baseFuel);
  $("base_tire").textContent = "¥" + fmt(baseTire);
  $("base_fail").textContent = "¥" + fmt(baseFail);
  $("base_total").textContent = "¥" + fmt(baseTotal);

  $("atis_fs").textContent = "¥" + fmt(atisFuelSav);
  $("atis_ts").textContent = "¥" + fmt(atisTireSav);
  $("atis_ms").textContent = "¥" + fmt(atisMaintYr);
  $("atis_rs").textContent = "¥" + fmt(atisFailSav);
  $("atis_total").textContent = "¥" + fmt(atisTotalSav);
  $("atis_cap").textContent = "¥" + fmt(atisCap);
  $("atis_pb_mo").textContent = isFinite(atisPaybackYears)? (atisPaybackYears*12).toFixed(1):"-";
  $("atis_roi").textContent = isFinite(atisCap) && atisCap>0 ? ((atisTotalSav-atisCap)/atisCap*100).toFixed(0)+"%" : "-";

  $("tpms_fs").textContent = "¥" + fmt(tpmsFuelSav);
  $("tpms_ts").textContent = "¥" + fmt(tpmsTireSav);
  $("tpms_rs").textContent = "¥" + fmt(tpmsFailSav);
  $("tpms_fee").textContent = "¥" + fmt(tpmsFeeYr);
  $("tpms_net").textContent = "¥" + fmt(tpmsNetSav);
  $("tpms_cap").textContent = "¥" + fmt(tpmsCap);
  $("tpms_pb_mo").textContent = isFinite(tpmsPaybackYears)? (tpmsPaybackYears*12).toFixed(1):"-";
  $("tpms_roi").textContent = isFinite(tpmsCap) && tpmsCap>0 ? ((tpmsNetSav-tpmsCap)/tpmsCap*100).toFixed(0)+"%" : "-";

  $("combo_fs").textContent = "¥" + fmt(comboFuelSav);
  $("combo_ts").textContent = "¥" + fmt(comboTireSav);
  $("combo_rs").textContent = "¥" + fmt(comboFailSav);
  $("combo_mgmt").textContent = "¥" + fmt(mgmt);
  $("combo_fee").textContent = "¥" + fmt(comboFeeYr);
  $("combo_net").textContent = "¥" + fmt(comboNet);
  $("combo_cap").textContent = "¥" + fmt(comboCap);
  $("combo_pb_mo").textContent = isFinite(comboPaybackYears)? (comboPaybackYears*12).toFixed(1):"-";
  $("combo_roi").textContent = isFinite(comboCap) && comboCap>0 ? ((comboNet-comboCap)/comboCap*100).toFixed(0)+"%" : "-";
}

document.querySelectorAll('input, select').forEach(el => el.addEventListener('input', calc));
$("scenario").addEventListener('change', applyScenario);
applyScenario();
</script>
</body>
</html>